(function(t){function e(e){for(var n,i,o=e[0],c=e[1],l=e[2],d=0,m=[];d<o.length;d++)i=o[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&m.push(a[i][0]),a[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(m.length)m.shift()();return s.push.apply(s,l||[]),r()}function r(){for(var t,e=0;e<s.length;e++){for(var r=s[e],n=!0,o=1;o<r.length;o++){var c=r[o];0!==a[c]&&(n=!1)}n&&(s.splice(e--,1),t=i(i.s=r[0]))}return t}var n={},a={app:0},s=[];function i(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=n,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var u=c;s.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"39e7":function(t,e,r){"use strict";var n=r("d113"),a=r.n(n);a.a},"56d7":function(t,e,r){"use strict";r.r(e);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"app"}},[r("pm-nav-bar",{attrs:{user:t.user,"menu-expanded":t.menuExpanded},on:{"sign-out-clicked":t.signOut,"menu-clicked":t.switchMenuState}}),r("main",[r("router-view")],1)],1)},s=[],i=(r("96cf"),r("1da1")),o=r("d4ec"),c=r("bee2"),l=r("59ca"),u=r.n(l),d=(r("ea7b"),r("e71f"),r("588e"),{apiKey:"AIzaSyAtmFdjojbKNtlMVCX5qs7pNedni5_vZEM",authDomain:"vue-blog-prod.firebaseapp.com",databaseURL:"https://vue-blog-prod.firebaseio.com",projectId:"vue-blog-prod",storageBucket:"vue-blog-prod.appspot.com",messagingSenderId:"885754221656",appId:"1:9876543210:web:yyyyyyyyyy"});u.a.initializeApp(d);var m=u.a,p=function(){function t(){Object(o["a"])(this,t),this.auth=m.auth()}return Object(c["a"])(t,[{key:"onStateChanged",value:function(t){this.auth.onAuthStateChanged(t)}},{key:"signUp",value:function(t,e){return this.auth.createUserWithEmailAndPassword(t,e)}},{key:"signIn",value:function(t,e){return this.auth.signInWithEmailAndPassword(t,e)}},{key:"signOut",value:function(){return this.auth.signOut()}},{key:"update",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e,r,n){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.reauthenticate(e);case 2:if(a=t.sent,!r){t.next=6;break}return t.next=6,a.updateEmail(r);case 6:if(!n){t.next=9;break}return t.next=9,a.updatePassword(n);case 9:case"end":return t.stop()}}),t,this)})));function e(e,r,n){return t.apply(this,arguments)}return e}()},{key:"retire",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.reauthenticate(e);case 2:return r=t.sent,t.next=5,r.delete();case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"reauthenticate",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=this.auth.currentUser,n=m.auth.EmailAuthProvider.credential(r.email,e),r.reauthenticateWithCredential(n),t.abrupt("return",r);case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()}]),t}(),h=new p,f=function(){function t(){Object(o["a"])(this,t)}return Object(c["a"])(t,[{key:"getItem",value:function(t){var e=localStorage.getItem(t);return null!=e?JSON.parse(e):null}},{key:"setItem",value:function(t,e){null!=e?localStorage.setItem(t,JSON.stringify(e)):localStorage.setItem(t,null)}},{key:"removeItem",value:function(t){localStorage.removeItem(t)}}]),t}(),v=new f,b=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("nav",{staticClass:"navbar has-shadow",attrs:{id:"nav",role:"navigation","aria-label":"main navigation"}},[r("div",{staticClass:"container"},[r("div",{staticClass:"navbar-brand"},[r("router-link",{staticClass:"navbar-item",attrs:{to:"/"}},[t._v("Vue-blog")]),r("a",{staticClass:"navbar-burger burger",class:{"is-active":t.menuExpanded},attrs:{role:"button",id:"navbar-burger","aria-label":"menu","aria-expanded":"false","data-target":"navbar-links"},on:{click:t.onMenuClicked}},[r("span",{attrs:{"aria-hidden":"true"}}),r("span",{attrs:{"aria-hidden":"true"}}),r("span",{attrs:{"aria-hidden":"true"}})])],1),r("div",{staticClass:"navbar-menu",class:{"is-active":t.menuExpanded},attrs:{id:"navbar-links"}},[t.user?r("div",{staticClass:"navbar-end"},[r("router-link",{staticClass:"navbar-item",attrs:{to:{name:"bookmark_new"}}},[r("pm-icon",{attrs:{name:"bookmark"}}),r("span",[t._v("ブックマークする")])],1),r("div",{staticClass:"navbar-item has-dropdown is-hoverable"},[r("a",{staticClass:"navbar-link"},[r("pm-icon",{attrs:{name:"user"}})],1),r("div",{staticClass:"navbar-dropdown is-right"},[r("router-link",{staticClass:"navbar-item",attrs:{to:{name:"profile"}}},[r("pm-icon",{attrs:{name:"address-card"}}),r("span",[t._v("プロファイル")])],1),r("router-link",{staticClass:"navbar-item",attrs:{to:{name:"auth_edit"}}},[r("pm-icon",{attrs:{name:"user-edit"}}),r("span",[t._v("認証情報変更")])],1),r("a",{staticClass:"navbar-item",on:{click:t.signOut}},[r("pm-icon",{attrs:{name:"sign-out-alt"}}),r("span",[t._v("サインアウト")])],1)],1)])],1):r("div",{staticClass:"navbar-end"},[r("div",{staticClass:"navbar-item"},[r("router-link",{staticClass:"button is-text",attrs:{to:{name:"sign_in"}}},[r("pm-icon",{attrs:{name:"sign-in-alt"}}),r("span",[t._v("サインイン")])],1)],1),r("div",{staticClass:"navbar-item"},[r("router-link",{staticClass:"button is-text",attrs:{to:{name:"sign_up"}}},[r("span",{staticClass:"icon"},[r("pm-icon",{attrs:{name:"user-plus"}})],1),r("span",[t._v("サインアップ")])])],1)])])])])},k=[],g=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("span",{staticClass:"icon"},[r("i",{class:t.classes})])},w=[],x=(r("caad"),r("b0c0"),{name:"pm-icon",props:{name:String,mode:{type:String,validator:function(t){return["fas","far","fab"].includes(t)},default:"fas"}},computed:{classes:function(){return[this.mode,"fa-".concat(this.name)]}}}),C=x,_=r("2877"),y=Object(_["a"])(C,g,w,!1,null,null,null),O=y.exports,j={name:"pm-nav-bar",components:{pmIcon:O},props:{user:Object,menuExpanded:Boolean},methods:{signOut:function(){this.$emit("sign-out-clicked")},onMenuClicked:function(){this.$emit("menu-clicked",this.menuExpanded)}}},E=j,R=Object(_["a"])(E,b,k,!1,null,null,null),S=R.exports,P={name:"app",components:{pmNavBar:S},data:function(){return{user:null,menuExpanded:!1}},created:function(){var t=this;v.removeItem("users"),h.onStateChanged((function(e){t.user=e})),this.$router.beforeEach((function(e,r,n){t.menuExpanded=!1,n()}))},methods:{signOut:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,h.signOut();case 2:this.$router.push({name:"home"});case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),switchMenuState:function(t){this.menuExpanded=!t}}},$=P,U=Object(_["a"])($,a,s,!1,null,null,null),A=U.exports,I=r("8c4f"),N=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container"},[r("div",{staticClass:"columns is-multiline bookmarks"},t._l(t.bookmarks,(function(t){return r("div",{key:t.id,staticClass:"column is-4"},[r("pm-bookmark-card",{attrs:{id:t.id,url:t.url,title:t.title,userCount:t.userCount,createdAt:t.createdAt}})],1)})),0),r("div",{staticClass:"columns"},[r("div",{staticClass:"column is-12"},[t.hasNext?r("button",{staticClass:"button is-rounded is-fullwidth",on:{click:t.loadNextBookmarks}},[t._v(" もっとみる ")]):t._e()])])])},M=[],B=r("2909"),D=(r("a4d3"),r("e01a"),r("d28b"),r("4de4"),r("d81d"),r("e439"),r("dbb4"),r("b64b"),r("d3b7"),r("3ca3"),r("159b"),r("ddb0"),r("ade3"));function T(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function F(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?T(Object(r),!0).forEach((function(e){Object(D["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var z=function(){function t(){Object(o["a"])(this,t),this.db=m.firestore()}return Object(c["a"])(t,[{key:"getBookmarks",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e,r){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=this.db.collection("bookmarks"),r&&(n=n.where("createdAt","<",r)),t.next=4,n.orderBy("createdAt","desc").limit(e).get();case 4:return a=t.sent,t.abrupt("return",a.docs.map((function(t){return F({},t.data(),{id:t.id,createdAt:t.data().createdAt.toDate()})})));case 6:case"end":return t.stop()}}),t,this)})));function e(e,r){return t.apply(this,arguments)}return e}()},{key:"getBookmark",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null!=e){t.next=2;break}return t.abrupt("return",null);case 2:return t.next=4,this.db.collection("bookmarks").doc(e).get();case 4:if(r=t.sent,!r.exists){t.next=7;break}return t.abrupt("return",F({},r.data(),{id:e}));case 7:return t.abrupt("return",null);case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getBookmarkComments",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var r,n,a,s,i,o,c,l,u,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.db.collection("bookmarks").doc(e).collection("comments").get();case 2:r=t.sent,n=[],a=!0,s=!1,i=void 0,t.prev=7,o=r.docs[Symbol.iterator]();case 9:if(a=(c=o.next()).done){t.next=19;break}return l=c.value,u=l.data().userId,t.next=14,this.db.collection("users").doc(u).get();case 14:d=t.sent,n.push(F({},l.data(),{id:l.id,user:F({},d.data(),{id:u})}));case 16:a=!0,t.next=9;break;case 19:t.next=25;break;case 21:t.prev=21,t.t0=t["catch"](7),s=!0,i=t.t0;case 25:t.prev=25,t.prev=26,a||null==o.return||o.return();case 28:if(t.prev=28,!s){t.next=31;break}throw i;case 31:return t.finish(28);case 32:return t.finish(25);case 33:return t.abrupt("return",n);case 34:case"end":return t.stop()}}),t,this,[[7,21,25,33],[26,,28,32]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"addStar",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e,r,n){var a,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=this.db.collection("bookmarks").doc(e).collection("comments").doc(r),t.next=3,a.get();case 3:return s=t.sent,i=s.data().stars||[],i.push(n),t.abrupt("return",a.update({stars:i}));case 7:case"end":return t.stop()}}),t,this)})));function e(e,r,n){return t.apply(this,arguments)}return e}()}]),t}(),Y=new z,L=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"card"},[r("header",{staticClass:"card-header"},[r("p",{staticClass:"card-header-title"},[r("router-link",{attrs:{to:{name:"bookmark_detail",params:{id:t.id}}}},[t._v(t._s(t.userCount)+" users")])],1)]),r("div",{staticClass:"card-content"},[r("div",{staticClass:"content"},[r("div",[r("a",{attrs:{href:t.url}},[t._v(t._s(t.title))])]),r("div",[r("time",{staticClass:"is-size-7",attrs:{datetime:t.timestamp}},[t._v(t._s(t.timestamp))])])])])])},H=[],J=(r("a9e3"),r("5a0c")),V=r.n(J),W={name:"pm-bookmark-card",props:{id:String,title:String,url:String,userCount:Number,createdAt:Date},computed:{timestamp:function(){return V()(this.createdAt).format("YYYY-MM-DD HH:mm")}}},q=W,K=Object(_["a"])(q,L,H,!1,null,null,null),X=K.exports,Z={name:"home",components:{pmBookmarkCard:X},data:function(){return{bookmarks:[],user:null,hasNext:!1}},created:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,r=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return h.onStateChanged((function(t){r.user=t})),t.next=3,Y.getBookmarks(30);case 3:e=t.sent,this.bookmarks=e,this.hasNext=30===this.bookmarks.length;case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{loadNextBookmarks:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Y.getBookmarks(30,this.bookmarks[this.bookmarks.length-1].createdAt);case 2:r=t.sent,this.hasNext=30===r.length,(e=this.bookmarks).push.apply(e,Object(B["a"])(r));case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},G=Z,Q=(r("39e7"),Object(_["a"])(G,N,M,!1,null,"2b154c8e",null)),tt=Q.exports,et=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("pm-page-title",{attrs:{title:"サインアップ"}}),r("section",{staticClass:"section"},[r("form",{staticClass:"container"},[r("pm-text-field",{attrs:{type:"email",placeholder:"メールアドレス",icon:"envelope"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),r("pm-text-field",{attrs:{type:"password",placeholder:"パスワード",icon:"lock"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),r("div",{staticClass:"field"},[r("p",{staticClass:"control"},[r("button",{staticClass:"button is-primary",on:{click:function(e){return e.preventDefault(),t.signUp(e)}}},[t._v(" サインアップ ")])])])],1)])],1)},rt=[],nt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"hero is-primary"},[r("div",{staticClass:"hero-body"},[r("div",{staticClass:"container"},[r("h1",{staticClass:"tilte"},[t._v(t._s(t.title))])])])])},at=[],st={name:"pm-page-title",props:{title:String}},it=st,ot=Object(_["a"])(it,nt,at,!1,null,null,null),ct=ot.exports,lt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"field"},[t.label?r("label",{staticClass:"label"},[t._v(t._s(t.label))]):t._e(),r("p",{staticClass:"control",class:{"has-icons-left":t.icon}},[r("input",{staticClass:"input",class:{"is-danger":t.error},attrs:{type:t.type,placeholder:t.placeholder},domProps:{value:t.value},on:{change:t.onChanged,input:t.input}}),t.icon?r("pm-icon",{staticClass:"is-small is-left",attrs:{name:t.icon}}):t._e()],1),t.error?r("p",{staticClass:"help is-danger"},[t._v(t._s(t.error))]):t._e()])},ut=[],dt={name:"pm-text-field",components:{pmIcon:O},props:{type:{type:String,label:String,default:"text",validator:function(t){return["text","email","password","search","url"].includes(t)}},placeholder:String,value:String,icon:String,error:String},methods:{input:function(t){t.target.value!==this.value&&this.$emit("input",t.target.value)},onChanged:function(t){this.$emit("change",t.target.value)}}},mt=dt,pt=Object(_["a"])(mt,lt,ut,!1,null,null,null),ht=pt.exports,ft=(r("c975"),r("82a7")),vt=r.n(ft);function bt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function kt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?bt(Object(r),!0).forEach((function(e){Object(D["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var gt=function(){function t(){Object(o["a"])(this,t),this.auth=m.auth(),this.db=m.firestore()}return Object(c["a"])(t,[{key:"getCurrentUser",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null!=this.auth.currentUser){t.next=2;break}throw new Error("サインインしていません。　サインインしてください");case 2:return t.next=4,this.db.collection("users").where("authId","==",this.auth.currentUser.uid).get();case 4:return e=t.sent,r=null,e.forEach((function(t){r=t.data(),r.id=t.id})),t.abrupt("return",r);case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"createUser",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={authId:e.uid,name:e.email.substr(0,e.email.indexOf("@")),gravatarUrl:vt.a.url(e.email)},t.next=3,this.db.collection("users").add(r);case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getUser",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var r,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=v.getItem("users")||{},r[e]){t.next=9;break}return t.next=4,this.db.collection("users").doc(e).get();case 4:n=t.sent,a=null,n.exists&&(a=kt({},n.data(),{id:e})),r[e]=a,v.setItem("users",r);case 9:return t.abrupt("return",r[e]);case 10:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"updateUser",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e,r){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.db.collection("users").doc(e);case 2:return n=t.sent,t.abrupt("return",n.update(r));case 4:case"end":return t.stop()}}),t,this)})));function e(e,r){return t.apply(this,arguments)}return e}()}]),t}(),wt=new gt,xt={name:"sign_up",components:{pmPageTitle:ct,pmTextField:ht},data:function(){return{email:null,password:null}},methods:{signUp:function(){var t=this;h.signUp(this.email,this.password).then((function(t){return wt.createUser(t.user)})).then((function(){t.$router.push({name:"home"})})).catch((function(t){alert(t.message)}))}}},Ct=xt,_t=Object(_["a"])(Ct,et,rt,!1,null,null,null),yt=_t.exports,Ot=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("pm-page-title",{attrs:{title:"サインイン"}}),r("section",{staticClass:"section"},[r("form",{staticClass:"container"},[r("pm-text-field",{attrs:{type:"email",placeholder:"メールアドレス",icon:"envelope"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),r("pm-text-field",{attrs:{type:"password",placeholder:"パスワード",icon:"lock"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),r("div",{staticClass:"field is-grouped"},[r("p",{staticClass:"control"},[r("button",{staticClass:"button is-primary",on:{click:function(e){return e.preventDefault(),t.signIn(e)}}},[t._v(" サインイン ")])])])],1)])],1)},jt=[],Et={name:"sign_in",components:{pmPageTitle:ct,pmTextField:ht},data:function(){return{email:null,password:null}},methods:{signIn:function(){var t=this;h.signIn(this.email,this.password).then((function(){t.$router.push({name:"home"})})).catch((function(t){alert(t.message)}))}}},Rt=Et,St=Object(_["a"])(Rt,Ot,jt,!1,null,null,null),Pt=St.exports,$t=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("pm-page-title",{attrs:{title:"ブックマークの登録"}}),r("section",{staticClass:"section"},[r("form",{staticClass:"container"},[r("pm-text-field",{attrs:{placeholder:"タイトル",error:t.titleError},on:{change:t.validateTitle},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),r("pm-text-field",{attrs:{type:"url",placeholder:"URL",error:t.urlError},on:{change:t.validateUrl},model:{value:t.url,callback:function(e){t.url=e},expression:"url"}}),r("pm-text-field",{attrs:{placeholder:"コメント",error:t.commentError},on:{change:t.validateComment},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}}),r("div",{staticClass:"field is-grouped"},[r("div",{staticClass:"control"},[r("button",{staticClass:"button is-primary",on:{click:function(e){return e.preventDefault(),t.addBookmark(e)}}},[t._v(" 登録する ")])])])],1)])],1)},Ut=[];function At(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function It(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?At(Object(r),!0).forEach((function(e){Object(D["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):At(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var Nt=function(){function t(){Object(o["a"])(this,t),this.db=m.firestore()}return Object(c["a"])(t,[{key:"getBookmark",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e,r){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.db.collection("users").doc(e.id).collection("bookmarks").where("url","==",r).get();case 2:if(n=t.sent,!n.empty){t.next=5;break}return t.abrupt("return",null);case 5:return a=null,n.forEach((function(t){a=t.data(),a.id=t.id})),t.abrupt("return",a);case 8:case"end":return t.stop()}}),t,this)})));function e(e,r){return t.apply(this,arguments)}return e}()},{key:"addBookmark",value:function(t,e){return e.bookmarkedAt=m.firestore.FieldValue.serverTimestamp(),this.db.collection("users").doc(t.id).collection("bookmarks").add(e)}},{key:"getBookmarks",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.db.collection("users").doc(e.id).collection("bookmarks").orderBy("bookmarkedAt","desc").get();case 2:return r=t.sent,t.abrupt("return",r.docs.map((function(t){return It({},t.data(),{bookmarkedAt:t.data().bookmarkedAt.toDate(),id:t.id})})));case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()}]),t}(),Mt=new Nt,Bt={name:"bookmark_new",components:{pmPageTitle:ct,pmTextField:ht},data:function(){return{title:null,url:null,comment:null,titleError:null,urlError:null,commentError:null}},methods:{addBookmark:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,r,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.validateAll(),e=this.titleError||this.urlError||this.commentError,!e){t.next=5;break}return alert("入力値が不正です。"),t.abrupt("return");case 5:return t.next=7,wt.getCurrentUser();case 7:return r=t.sent,t.next=10,Mt.getBookmark(r,this.url);case 10:if(n=t.sent,null==n){t.next=14;break}return alert("すでに登録されているURLです。"),t.abrupt("return");case 14:return a={title:this.title,url:this.url,comment:this.comment},t.prev=15,t.next=18,Mt.addBookmark(r,a);case 18:this.$router.push({name:"home"}),t.next=24;break;case 21:t.prev=21,t.t0=t["catch"](15),alert(t.t0.message);case 24:case"end":return t.stop()}}),t,this,[[15,21]])})));function e(){return t.apply(this,arguments)}return e}(),validateAll:function(){this.validateTitle(this.title),this.validateUrl(this.url),this.validateComment(this.comment)},validateTitle:function(t){this.titleError=null,t?t.length>50&&(this.titleError="タイトルは50文字までです。"):this.titleError="タイトルは必須です"},validateUrl:function(t){this.urlError=null,t||(this.urlError="URLは必須です")},validateComment:function(t){this.commentError=t&&t.length>150?"コメントは150文字までです":null}}},Dt=Bt,Tt=Object(_["a"])(Dt,$t,Ut,!1,null,null,null),Ft=Tt.exports,zt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.bookmark?r("div",[r("section",{staticClass:"hero is-primary"},[r("div",{staticClass:"hero-body"},[r("div",{staticClass:"container"},[r("h1",{staticClass:"title"},[r("a",{attrs:{href:t.bookmark.url}},[t._v(t._s(t.bookmark.title))])]),r("h2",{staticClass:"subtitle"},[t._v(t._s(t.bookmark.userCount)+" USERS")])])])]),r("section",{staticClass:"section content comments"},[r("h2",[t._v("コメント")]),t._l(t.comments,(function(e){return r("pm-user-comment",{key:e.id,attrs:{"avatar-url":e.user.avatarUrl||e.user.gravatarUrl,"user-name":e.user.name,comment:e.comment,commentId:e.id,stars:e.stars,"show-add-button":t.isSignedIn},on:{"add-star":t.addStar}})}))],2)]):t._e()},Yt=[],Lt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("article",{staticClass:"media"},[r("figure",{staticClass:"media-left"},[r("p",{staticClass:"image is-64x64"},[r("img",{attrs:{src:t.avatarUrl}})])]),r("div",{staticClass:"media-content"},[r("div",{staticClass:"content"},[r("strong",[t._v(t._s(t.userName))]),r("div",[t._v(t._s(t.comment))])]),t.comment?r("nav",{staticClass:"level"},[r("div",{staticClass:"level-left"},[t.showAddButton?r("button",{staticClass:"level-item button is-outlined is-info",on:{click:t.addStar}},[r("pm-icon",{staticClass:"is-small",attrs:{mode:"far",name:"star"}})],1):t._e(),t._l(t.stars,(function(t){return r("pm-star",{key:t,attrs:{userId:t}})}))],2)]):t._e()])])},Ht=[],Jt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("pm-icon",{staticClass:"is-small has-text-info tooltip",attrs:{name:"star","data-tooltip":t.userName},nativeOn:{"~mouseover":function(e){return t.loadUserName(e)}}})},Vt=[],Wt={name:"pm-star",components:{pmIcon:O},props:{userId:{type:String,required:!0}},data:function(){return{userName:null}},methods:{loadUserName:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.userName){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,wt.getUser(this.userId);case 4:e=t.sent,this.userName=e?e.name:"不明なユーザー";case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},qt=Wt,Kt=Object(_["a"])(qt,Jt,Vt,!1,null,null,null),Xt=Kt.exports,Zt={name:"pm-user-comment",components:{pmIcon:O,pmStar:Xt},props:{avatarUrl:String,userName:String,comment:String,commentId:String,stars:Array,showAddButton:Boolean},methods:{addStar:function(){this.$emit("add-star",this.commentId)}}},Gt=Zt,Qt=Object(_["a"])(Gt,Lt,Ht,!1,null,null,null),te=Qt.exports,ee={name:"bookmark_detail",components:{pmUserComment:te},data:function(){return{bookmark:null,comments:null,isSignedIn:!1}},created:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,r=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return h.onStateChanged((function(t){r.isSignedIn=null!=t})),e=this.$route.params.id,t.next=4,Y.getBookmark(e);case 4:return this.bookmark=t.sent,null==this.bookmark&&this.$router.push({name:"error_not_found"}),t.next=8,Y.getBookmarkComments(e);case 8:this.comments=t.sent;case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{addStar:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.isSignedIn){t.next=10;break}return t.next=3,wt.getCurrentUser();case 3:return r=t.sent,n=this.$route.params.id,t.next=7,Y.addStar(n,e,r.id);case 7:return t.next=9,Y.getBookmarkComments(n);case 9:this.comments=t.sent;case 10:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()}},re=ee,ne=Object(_["a"])(re,zt,Yt,!1,null,null,null),ae=ne.exports,se=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container"},[t.profile?r("div",{staticClass:"columns"},[r("div",{staticClass:"column is-one-fifth"},[r("p",{staticClass:"image is-128x128"},[r("img",{attrs:{src:t.profile.avatarUrl||t.profile.gravatarUrl}})]),r("p",[t._v("name: "+t._s(t.profile.name))]),r("div",{staticClass:"columns"},[r("div",{staticClass:"column"},[r("button",{staticClass:"button is-small is-primary is-outlined",on:{click:t.showProfileEditModal}},[t._v(" 編集 ")])]),r("div",{staticClass:"column"},[r("button",{staticClass:"button is-small is-primary is-outlined is-fullwidth",on:{click:t.showRetireModal}},[t._v(" 退会 ")])])])]),r("div",{staticClass:"column is-for-fifths"},t._l(t.bookmarks,(function(e){return r("div",{key:e.id,staticClass:"card"},[r("div",{staticClass:"card-content"},[r("div",{staticClass:"content"},[r("div",[r("a",{attrs:{href:e.url}},[t._v(t._s(e.title))])]),r("div",[t._v(t._s(e.comment))]),r("div",[r("time",{staticClass:"is-size-7",attrs:{datatime:t.formatTime(e.bookmarkedAt)}},[t._v(t._s(t.formatTime(e.bookmarkedAt)))])])])])])})),0)]):t._e(),t.profile?r("pm-profile-edit-modal",{attrs:{name:t.profile.name},on:{update:t.updateProfile},model:{value:t.editProfileModalActive,callback:function(e){t.editProfileModalActive=e},expression:"editProfileModalActive"}}):t._e(),t.profile?r("pm-retire-modal",{on:{retire:t.retire},model:{value:t.retireModalActive,callback:function(e){t.retireModalActive=e},expression:"retireModalActive"}}):t._e()],1)},ie=[],oe=(r("99af"),function(){function t(){Object(o["a"])(this,t),this.ref=m.storage().ref()}return Object(c["a"])(t,[{key:"uploadAvatar",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e,r){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n="users/".concat(e,"/").concat(r.name),t.next=3,this.ref.child(n).put(r);case 3:return a=t.sent,t.next=6,a.ref.getDownloadURL();case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t,this)})));function e(e,r){return t.apply(this,arguments)}return e}()}]),t}()),ce=new oe,le=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"modal",class:{"is-active":t.active}},[r("div",{staticClass:"modal-background"}),r("div",{staticClass:"modal-card"},[r("header",{staticClass:"modal-card-head"},[r("p",{staticClass:"modal-card-title"},[t._v("プロファイル取得")]),r("button",{staticClass:"delete",attrs:{"aria-label":"close"},on:{click:t.cancel}})]),r("section",{staticClass:"modal-card-body"},[r("pm-text-field",{attrs:{type:"text",label:"ユーザー名",placeholder:"ユーザー名",error:t.userNameError},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}}),r("div",{staticClass:"field"},[r("label",{staticClass:"label"},[t._v("アバター画像")]),r("div",{staticClass:"control"},[r("div",{staticClass:"file has-name"},[r("label",{staticClass:"file-label"},[r("input",{staticClass:"file-input",attrs:{type:"file",name:"resume"},on:{change:function(e){return e.preventDefault(),t.selectFile(e)}}}),t._m(0),r("span",{staticClass:"file-name"},[t._v(" "+t._s(t.avatarFile?t.avatarFile.name:"")+" ")])])])])])],1),r("footer",{staticClass:"modal-card-foot"},[r("button",{staticClass:"button is-primary",on:{click:t.update}},[t._v("更新")]),r("button",{staticClass:"button",on:{click:t.cancel}},[t._v("キャンセル")])])])])},ue=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("span",{staticClass:"file-cta"},[r("span",{staticClass:"file-icon"},[r("i",{staticClass:"fas fa-upload"})]),r("span",{staticClass:"file-label"},[t._v("Choose a file...")])])}],de={name:"pm-profile-edit-modal",components:{pmTextField:ht},props:{name:String,value:Boolean},data:function(){return{userName:this.name,userNameError:null,avatarFile:null}},computed:{active:{get:function(){return this.value},set:function(t){this.value!==t&&this.$emit("input",t)}}},methods:{update:function(){var t=this;this.userName?this.$emit("update",{name:this.userName,file:this.avatarFile,teardown:function(){t.userNameError=null,t.avatarFile=null,t.active=!1}}):this.userNameError="ユーザー名は必須です"},cancel:function(){this.userName=this.name,this.userNameError=null,this.avatarFile=null,this.active=!1},selectFile:function(t){this.avatarFile=t.target.files[0]}}},me=de,pe=Object(_["a"])(me,le,ue,!1,null,null,null),he=pe.exports,fe=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"modal",class:{"is-active":t.active}},[r("div",{staticClass:"modal-background"}),r("div",{staticClass:"modal-card"},[r("header",{staticClass:"modal-card-head"},[r("p",{staticClass:"modal-card-title"},[t._v("退会しますか?")]),r("button",{staticClass:"delete",attrs:{"aria-label":"close"},on:{click:t.cancel}})]),r("section",{staticClass:"modal-card-body"},[r("div",{staticClass:"notification is-danger"},[t._v(" 退会するには現在のパスワードを入力して「退会する」ボタンをクリックしてください。この処理は元に戻すことはできません。 ")]),r("pm-text-field",{attrs:{label:"現在のパスワード（必須）",type:"password",placeholder:"パスワード",icon:"key",error:t.passwordError},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),r("footer",{staticClass:"modal-card-foor"},[r("button",{staticClass:"button is-danger",on:{click:t.retire}},[t._v("退会する")]),r("button",{staticClass:"button",on:{click:t.cancel}},[t._v("キャンセル")])])])])},ve=[],be={name:"pm-retire-modal",components:{pmTextField:ht},props:{value:Boolean},data:function(){return{password:null,passwordError:null}},computed:{acrive:{get:function(){return this.value},set:function(t){this.value!==t&&this.$emit("input",t)}}},methods:{retire:function(){this.password?this.$emit("retire",{password:this.password,teardown:this.cancel}):this.passwordError="現在のパスワードは必須です"},cancel:function(){this.password=null,this.passwordError=null,this.active=!1}}},ke=be,ge=Object(_["a"])(ke,fe,ve,!1,null,null,null),we=ge.exports,xe={name:"profile",components:{pmProfileEditModal:he,pmRetireModal:we},data:function(){return{user:null,profile:null,bookmarks:[],editProfileModalActive:!1}},created:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:h.onStateChanged(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.user=r,!r){t.next=8;break}return t.next=4,wt.getCurrentUser();case 4:return e.profile=t.sent,t.next=7,Mt.getBookmarks(e.profile);case 7:e.bookmarks=t.sent;case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),methods:{showProfileEditModal:function(){this.editProfileModalActive=!0},showRetireModal:function(){this.retireModalActive=!0},updateProfile:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r={name:e.name},!e.file){t.next=5;break}return t.next=4,ce.uploadAvatar(this.profile.id,e.file);case 4:r.avatarUrl=t.sent;case 5:return t.next=7,wt.updateUser(this.profile.id,r);case 7:return t.next=9,wt.getCurrentUser();case 9:this.profile=t.sent,e.teardown&&e.teardown();case 11:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),retire:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,h.retire(e.password);case 2:return this.retireModalActive=!1,t.next=5,h.signOut();case 5:window.location.href="/thanks";case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),formatTime:function(t){return V()(t).format("YYYY-MM-DD HH:mm")}}},Ce=xe,_e=Object(_["a"])(Ce,se,ie,!1,null,null,null),ye=_e.exports,Oe=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("pm-page-title",{attrs:{title:"認証情報変更"}}),r("section",{staticClass:"section"},[r("form",{staticClass:"container"},[r("pm-text-field",{attrs:{label:"現在のパスワード（必須）",type:"password",placeholder:"パスワード",icon:"key"},model:{value:t.currentPassword,callback:function(e){t.currentPassword=e},expression:"currentPassword"}}),r("pm-text-field",{attrs:{label:"新しいメールアドレス",type:"email",placeholder:"メールアドレス",icon:"envelope"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),r("pm-text-field",{attrs:{label:"新しいパスワード",type:"password",placeholder:"パスワード",icon:"lock"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),r("div",{staticClass:"field is-grouped"},[r("div",{staticClass:"control"},[r("button",{staticClass:"button is-primary",on:{click:function(e){return e.preventDefault(),t.update(e)}}},[t._v(" 更新 ")])])])],1)])],1)},je=[],Ee=(r("ac1f"),r("5319"),{name:"auth_edit",components:{pmPageTitle:ct,pmTextField:ht},data:function(){return{email:null,password:null,currentPassword:null}},created:function(){var t=this;h.onStateChanged((function(e){t.user=e}))},methods:{update:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!this.email&&!this.password){t.next=12;break}return t.next=4,h.update(this.currentPassword,this.email,this.password);case 4:return this.$router.replace({name:"home"}),t.next=7,h.signOut();case 7:return t.next=9,h.signIn(this.email||this.user.email,this.password||this.currentPassword);case 9:alert("正常に更新されました"),t.next=13;break;case 12:alert("メールアドレスかパスワードのどちらかは入力してください");case 13:t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](0),alert(t.t0.message);case 18:case"end":return t.stop()}}),t,this,[[0,15]])})));function e(){return t.apply(this,arguments)}return e}()}}),Re=Ee,Se=Object(_["a"])(Re,Oe,je,!1,null,null,null),Pe=Se.exports,$e=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},Ue=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"hero is-info"},[r("div",{staticClass:"hero-body"},[r("div",{staticClass:"container"},[r("h1",{staticClass:"title"},[t._v("ご利用ありがとうございました")])])])])}],Ae={name:"thanks"},Ie=Ae,Ne=Object(_["a"])(Ie,$e,Ue,!1,null,null,null),Me=Ne.exports,Be=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},De=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"hero is-danger"},[r("div",{staticClass:"hero-body"},[r("div",{staticClass:"container"},[r("h1",{staticClass:"title"},[t._v("404: Not Found")])])])])}],Te={name:"error_not_found"},Fe=Te,ze=Object(_["a"])(Fe,Be,De,!1,null,null,null),Ye=ze.exports,Le=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},He=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"hero is-danger"},[r("div",{staticClass:"hero-body"},[r("div",{staticClass:"container"},[r("h1",{staticClass:"title"},[t._v("401: Unauthorized")])])])])}],Je={name:"error_unauthorized"},Ve=Je,We=Object(_["a"])(Ve,Le,He,!1,null,null,null),qe=We.exports;n["a"].use(I["a"]);var Ke=new I["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",component:tt},{path:"/sign_up",name:"sign_up",component:yt},{path:"/sign_in",name:"sign_in",component:Pt},{path:"/bookmarks/new",name:"bookmark_new",component:Ft,meta:{private:!0}},{path:"/bookmarks/:id",name:"bookmark_detail",component:ae},{path:"/profile",name:"profile",component:ye,meta:{private:!0}},{path:"/auth/edit",name:"auth_edit",component:Pe,meta:{private:!0}},{path:"/thanks",name:"thanks",component:Me},{path:"/not_found",name:"error_not_found",component:Ye},{path:"/unauthorized",name:"error_unauthorized",component:qe},{path:"*",name:"error_unknown_path",component:Ye}]});Ke.beforeEach((function(t,e,r){t.matched.some((function(t){return t.meta.private}))?h.onStateChanged((function(t){t?r():r({name:"error_unauthorized"})})):r()}));var Xe=Ke;n["a"].config.productionTip=!1,new n["a"]({router:Xe,render:function(t){return t(A)}}).$mount("#app")},d113:function(t,e,r){}});
//# sourceMappingURL=app.f4e53979.js.map